@page "/users"
@using ABCShared.Library.Constants

@attribute [ShouldHavePermission(SchoolAction.Read, SchoolFeature.Users)]

<Header OnReturn="ReturnHome" Title="Users" Description="Manage Users" />
<MudTable Items="UserList"
		  Loading="_isLoading"
		  LoadingProgressColor="Color.Info"
		  Elevation="25">
	<ToolBarContent>
		<MudFab StartIcon="@Icons.Material.Filled.Add"
				IconSize="Size.Medium"
				OnClick="InvokeUserRegistrationDialogAsync"
				Size="Size.Small"
				Class="mr-2" />
	</ToolBarContent>
	<HeaderContent>
		<MudTh>Username</MudTh>
		<MudTh>First Name</MudTh>
		<MudTh>Last Name</MudTh>
		<MudTh>Phone Number</MudTh>
		<MudTh>Active</MudTh>
	</HeaderContent>
	<RowTemplate>
		<MudTd DataLabel="User Name">@context.UserName</MudTd>
		<MudTd DataLabel="First Name">@context.FirstName</MudTd>
		<MudTd DataLabel="Last Name">@context.LastName</MudTd>
		<MudTd DataLabel="Phone Number">@context.PhoneNumber</MudTd>
		<MudTd DataLabel="Is Active">
			<MudCheckBox @bind-Value="@context.IsActive"
						 ReadOnly
						 Color="Color.Secondary" />
		</MudTd>
		<MudTd DataLabel="Actions">
			<MudMenu Icon="@Icons.Material.Filled.MoreVert"
					 Size="Size.Small"
					 Color="Color.Secondary"
					 TransformOrigin="Origin.TopLeft"
					 AnchorOrigin="Origin.TopLeft">
				<MudMenuItem OnClick="@(() => GoToRoles(context.Id))">View Roles</MudMenuItem>
				@if (context.IsActive)
				{
					<MudMenuItem OnClick="@(() => ChangeStatusAsync(context))">Deactivate</MudMenuItem>
				}
				else
				{
					<MudMenuItem OnClick="@(()=> ChangeStatusAsync(context))">Activate</MudMenuItem>
				}
			</MudMenu>
		</MudTd>
	</RowTemplate>
	<PagerContent>
		<MudTablePager RowsPerPageString="RowsPerPageString" InfoFormat="InfoFormat" />
	</PagerContent>
</MudTable>
