@page "/role-permissions/{RoleId}"

<Header Title="@_title" Description="@_description" OnReturn="ReturnToRoles" />

@if (_isLoading)
{
	<MudProgressCircular Color="Color.Primary" Indeterminate="true" />
}
else
{
	<MudTabs Elevation="25"
			 Rounded="true"
			 Centered="true"
			 ApplyEffectsToContainer="true"
			 AlwaysShowScrollButtons="true">

		@foreach (var group in RoleClaimsGroup.Keys)
		{
			var assignedRoleClaimsInGroup = RoleClaimsGroup[group]
			.Where(rcvm => rcvm.IsSelected).ToList();

			var allRoleClaimsInGroup = RoleClaimsGroup[group].ToList();

			<MudTabPanel Text="@group" BadgeData="@($"{assignedRoleClaimsInGroup.Count}/{allRoleClaimsInGroup.Count}")"
						 Style="padding-right: 42px;" BadgeColor="@GetGroupBadgeColor(assignedRoleClaimsInGroup.Count,allRoleClaimsInGroup.Count)">


				<MudTable Items="@allRoleClaimsInGroup"
						  Elevation="25"
						  Style="margin-bottom: 0px!important">
					<ToolBarContent>
						@if (_canUpdateRolePermissions)
						{
							<MudButton OnClick="UpdateRolePermissionsAsync" Variant="Variant.Filled"
									   Color="Color.Primary">
								Update Permissions
							</MudButton>
						}
					</ToolBarContent>
					<HeaderContent>
						<MudTh>Name</MudTh>
						<MudTh>Description</MudTh>
						<MudTh>Is Assigned</MudTh>
					</HeaderContent>
					<RowTemplate>
						<MudTd DataLabel="Name">@context.Name</MudTd>
						<MudTd DataLabel="Description">@context.Description</MudTd>
						<MudTd DataLabel="Is Assigned">
							<MudCheckBox @bind-Value="@context.IsSelected"										 
										 Color="Color.Secondary" />
						</MudTd>
					</RowTemplate>
					<PagerContent>
						<MudTablePager RowsPerPageString="@rowsPerPageString" InfoFormat="@infoFormat" />
					</PagerContent>
				</MudTable>


			</MudTabPanel>
		}

	</MudTabs>
}


